(function(){"use strict";const d=/[\u200b\u200c\u200d\u200e\u200f\u2060\ufeff]/g,f=e=>e.replace(/\r\n/g,`
`).replace(/\u00a0/g," ").replace(d,"").replace(/\s+/g," ").replace(/^["'""''\s]+|["'""''\s]+$/g,"").trim(),x=new RegExp(`(^|[\\s"'""'')\\]\\}\\.\\?!:;,]|(?<=[a-zA-Z0-9]))(?:\\(?([A-Za-z])\\)|([A-Za-z])[).:-]|([0-9]{1,2})[).:-])\\s*`,"g"),A=/^\s*(?:[-*â€¢]\s*)?(?:\(?([A-Za-z])\)|([A-Za-z])[).:-]|([0-9]{1,2})[).:-])\s*(.*)\s*$/,L=/^\s*([A-Za-z])\s*$/,b=e=>{if(/^\d+$/.test(e))return Number.parseInt(e,10);const r=e.toUpperCase().charCodeAt(0);return r>=65&&r<=90?r-64:-1},z=e=>{if(e.length<2)return[];let n=[];for(let r=0;r<e.length;r+=1){if(e[r].labelIndex!==1)continue;const t=[e[r]];let o=2;for(let l=r+1;l<e.length;l+=1){const a=e[l];if(a.labelIndex===o)t.push(a),o+=1;else{if(a.labelIndex<=o-1)continue;break}}t.length>n.length&&(n=t)}return n.length>=2?n:[]},B=e=>{const n=e.replace(/\r\n/g,`
`).replace(/\u00a0/g," ").replace(d,"").replace(/\s+/g," ").trim();if(!n)return null;x.lastIndex=0;const r=[];let t=x.exec(n);for(;t;){const i=t[1]||"",s=String(t[2]||t[3]||t[4]||"").toLowerCase(),u=b(s);s&&u>0&&r.push({index:t.index+i.length,matchLen:t[0].length-i.length,label:s,labelIndex:u}),t=x.exec(n)}const o=z(r);if(o.length<2)return null;const l=n.slice(0,o[0].index).trim();if(!l)return null;const a=[];return o.forEach((i,s)=>{const u=i.index+i.matchLen,c=o[s+1]?o[s+1].index:n.length,p=f(n.slice(u,c));p&&a.push(p)}),a.length<2?null:{stem:l,options:a,labels:o.map(i=>i.label)}},Z=(e,n)=>{const r=e.replace(/\r\n/g,`
`).replace(/\u00a0/g," ").replace(d,"").trim();if(!r)return null;const t=r.split(`
`).map(s=>s.trim()),o=t.map((s,u)=>{const c=s.match(A);if(!c)return null;const p=String(c[1]||c[2]||c[3]||"").toLowerCase(),m=b(p);return!p||m<=0?null:{lineIndex:u,label:p,labelIndex:m,inlineText:f(c[4]||"")}}).filter(s=>!!s),l=z(o);if(l.length<2)return null;const a=f(t.slice(0,l[0].lineIndex).join(" "));if(!(n!=null&&n.allowMissingStem)&&!a)return null;const i=[];return l.forEach((s,u)=>{var h;const c=((h=l[u+1])==null?void 0:h.lineIndex)??t.length,p=t.slice(s.lineIndex+1,c).map(C=>f(C)).filter(Boolean),m=[s.inlineText,...p].filter(Boolean).join(" "),g=f(m);g&&i.push(g)}),i.length<2?null:{stem:a,options:i,labels:l.map(s=>s.label)}},w=(e,n)=>{const r=e.replace(/\r\n/g,`
`).replace(/\u00a0/g," ").replace(d,"").trim();if(!r)return null;const t=r.split(`
`).map(s=>s.trim()).filter(Boolean);if(t.length<3)return null;const o=[];for(let s=0;s<t.length-1;s+=1){const u=t[s].match(L);if(u&&t[s+1]&&!t[s+1].match(L)){const c=u[1].toLowerCase(),p=b(c);p>0&&o.push({lineIndex:s,label:c,labelIndex:p})}}const l=z(o);if(l.length<2)return null;const a=f(t.slice(0,l[0].lineIndex).join(" "));if(!(n!=null&&n.allowMissingStem)&&!a)return null;const i=[];return l.forEach((s,u)=>{var g;const c=((g=l[u+1])==null?void 0:g.lineIndex)??t.length,m=t.slice(s.lineIndex+1,c).map(h=>f(h)).filter(Boolean).join(" ");m&&i.push(m)}),i.length<2?null:{stem:a,options:i,labels:l.map(s=>s.label)}},M=(e,n)=>Z(e,n)||w(e,n)||B(e),I=e=>e.split(`
`).map(n=>n.replace(/\s+/g," ").trim()).filter(Boolean).join(`
`).trim(),S=e=>/^\d+$/.test(e)?`${e}.`:`${e.toUpperCase()}.`,$=e=>e.replace(/\r\n/g,`
`).replace(/\u00a0/g," ").replace(/[\u200b\u200c\u200d\u200e\u200f\u2060\ufeff]/g,"").replace(/\t/g," ").trim(),T=e=>e.replace(/([?.!])\s*(\(?[A-Za-z]\)|[A-Za-z][).:-]|[0-9]{1,2}[).:-])\s*/g,`$1
$2 `).replace(/([A-Za-z0-9"'])(\s+)(\(?[B-Za-z]\)|[B-Z][).:-]|[b-z][).:-]|(?:1[0-9]|[2-9])[).:-])(\s*)/g,`$1
$3 `),q=e=>{const n=f(e.stem),r=e.options.map((t,o)=>`${S(e.labels[o]||String(o+1))} ${f(t)}`);return I([n,...r].join(`
`))},j=e=>{const n=M(e,{allowMissingStem:!0});if(n)return q(n);const r=T(e),t=M(r,{allowMissingStem:!0});return t?q(t):I(r)},k=e=>{const n=$(e.term||""),r=I($(e.def||""));return{term:j(n),def:r}},y=e=>e.map(n=>k(n));self.onmessage=e=>{var n;try{const r=Array.isArray((n=e.data)==null?void 0:n.terms)?e.data.terms:[],o={terms:y(r.map(l=>({term:typeof l.term=="string"?l.term:"",def:typeof l.def=="string"?l.def:""})))};self.postMessage(o)}catch{const r={terms:[]};self.postMessage(r)}}})();
